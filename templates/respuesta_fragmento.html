<div class="message-container user">
    <div class="message-content" style="justify-content: flex-end;">
        <div class="text-content"
            style="background-color: #2F3031; padding: 10px 16px; border-radius: 20px 2px 20px 20px; max-width: 70%;">
            {{ .mensaje_usuario }}
        </div>
    </div>
</div>

<div class="message-container bot">
    <div class="message-content">
        <div class="avatar bot">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path
                    d="M12 2C11.45 2 11 2.45 11 3V4H7C5.9 4 5 4.9 5 6V18C5 19.1 5.9 20 7 20H17C18.1 20 19 19.1 19 18V6C19 4.9 18.1 4 17 4H13V3C13 2.45 12.55 2 12 2ZM9 9C9.55 9 10 9.45 10 10C10 10.55 9.55 11 9 11C8.45 11 8 10.55 8 10C8 9.45 8.45 9 9 9ZM15 9C15.55 9 16 9.45 16 10C16 10.55 15.55 11 15 11C14.45 11 14 10.55 14 10C14 9.45 14.45 9 15 9ZM8 14H16V16H8V14Z"
                    fill="white" />
            </svg>
        </div>
        <div class="text-content">
            {{ if .encontrado }}
            <p>EncontrÃ© estos horarios para <strong>{{ .mensaje_usuario }}</strong>:</p>
            {{ range .resultados }}
            <div class="result-card" id="card-{{ .ID }}">
                <div style="font-size: 1.1em; font-weight: 500; color: #E3E3E3; margin-bottom: 4px;">{{ .Materia }}
                </div>
                <div style="color: #A8C7FA; font-size: 0.9em; margin-bottom: 2px;">{{ .Carrera }}</div>
                <div style="color: #C4C7C5; font-size: 0.9em;">
                    ğŸ“… {{ .Fecha }} &nbsp; | &nbsp; â° {{ .Hora }}
                </div>
                <div style="color: #C4C7C5; font-size: 0.9em;">
                    ğŸ“ {{ .Aula }} ({{ .Sede }})
                </div>
                <!-- Sede info needed if not in Aula string. Assuming Sede field populated. -->
                <div style="color: #999; font-size: 0.8em; margin-top: 4px;">
                    {{ .Turno }} &nbsp;|&nbsp; ğŸ”„ Act: {{ .FechaEdicion }}
                </div>
                <button onclick="downloadCard('card-{{ .ID }}')"
                    style="margin-top: 10px; background: transparent; border: 1px solid #555; color: #ddd; padding: 4px 8px; border-radius: 4px; cursor: pointer; font-size: 0.8em;">
                    ğŸ“¸ Descargar Imagen
                </button>
            </div>
            {{ end }}
            {{ else }}
            <p>Mmm, no encontrÃ© nada con ese nombre para esa mesa. Â¿QuerÃ©s intentar de nuevo?</p>
            {{ end }}
            <p style="margin-top: 10px; font-size: 0.9em; color: #888;">Si querÃ©s buscar otra, escribÃ­ el nÃºmero de
                mesa.</p>
        </div>
    </div>
</div>

{{ if .reset_state }}
<div id="form-state" hx-swap-oob="true">
    <input type="hidden" name="step" value="">
    <input type="hidden" name="mesa_filter" value="">
</div>
{{ end }}